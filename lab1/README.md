# Telegram Bot: Справочник музеев Санкт‑Петербурга

Простой Telegram‑бот на Python (python‑telegram‑bot v21+) со справочником музеев СПб.  
Хранит данные в локальном JSON (`data/museums.json`), поддерживает поиск и выдаёт карточки музеев.

## Возможности
- `/start`, `/help` — краткая справка и список команд
- `/list` — список всех музеев (id + название)
- `/find <запрос>` — умный поиск по названию (fuzzy + подстрока)
- `/museum <id|название>` — подробная карточка (название, график, адрес, билеты, сайт)
- `/random` — случайный музей
- `/ping` — проверка доступности

## Как бот отвечает
- Команды возвращают читаемые тексты с эмодзи и Markdown.
- На произвольный текст без команды — пытается угадать, какой музей имелся в виду, и предлагает варианты.
- При ошибках отвечает дружелюбным сообщением и (опционально) шлёт уведомление админу.

## Какие данные хранит
В файле `data/museums.json` хранится список объектов:
```json
[
  {
    "id": "1",
    "name": "Государственный Эрмитаж",
    "hours": "Вт, Чт, Сб, Вс 10:30–18:00; Ср, Пт 10:30–21:00; Пн — выходной",
    "address": "Дворцовая пл., 2",
    "tickets": "От 500 ₽ (льготы доступны); бесплатно для детей до 18",
    "url": "https://www.hermitagemuseum.org/"
  }
]
```
Вы можете редактировать файл вручную (id должны быть строками и уникальными). При отсутствии файла бот создаст минимальный набор по умолчанию.

> Хотите SQLite? Архитектура кода позволяет заменить `MuseumStore` на SQLite‑вариант — текущая версия использует JSON для простоты.

## Требования
- Python 3.10+
- Аккаунт Telegram BotFather токен
- Интернет‑доступ с машины, где запускается бот

## Быстрый старт (VS Code или терминал)
1. Скопируйте репозиторий/папку к себе.
2. Создайте `.env` по образцу `.env.example` и вставьте токен бота:
   ```env
   TELEGRAM_BOT_TOKEN=123456:ABC...your_token_here
   # ADMIN_USER_ID=123456789  # опционально, чтобы получать алерты
   ```
3. Создайте и активируйте виртуальное окружение:
   - **Windows (PowerShell)**
     ```powershell
     py -3 -m venv .venv
     .\.venv\Scripts\Activate.ps1
     ```
   - **macOS / Linux (bash/zsh)**
     ```bash
     python3 -m venv .venv
     source .venv/bin/activate
     ```
4. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
5. Запустите бота:
   ```bash
   python bot.py
   ```

## Запуск в Visual Studio (Windows)
> Речь о **Microsoft Visual Studio** (не VS Code). Убедитесь, что установлен рабочий набор **Python development**.
1. Создайте новый проект типа *Python Application* и добавьте в проект файлы `bot.py`, `requirements.txt`, `.env` и папку `data`.
2. Откройте **Solution Explorer → Щёлкните правой → Python Environments → Add Environment → Virtual environment** и создайте venv.
3. Откройте **Package Manager** и установите зависимости из `requirements.txt` (или в терминале проекта: `pip install -r requirements.txt`).
4. В свойствах проекта добавьте переменные среды или создайте `.env` в корне проекта по образцу.
5. Выберите `bot.py` стартовым файлом (**Set as Startup File**) и запустите (F5).

## Переменные окружения
- `TELEGRAM_BOT_TOKEN` — токен бота (обязательно)
- `ADMIN_USER_ID` — ваш Telegram ID для уведомлений об ошибках (опционально)

## Обработка ошибок
- Все исключения логируются.
- Пользователь получает мягкое сообщение.
- Если задан `ADMIN_USER_ID`, админ получает короткое уведомление с текстом ошибки.

## Структура проекта
```
.
├── bot.py
├── requirements.txt
├── .env.example
├── README.md
└── data
    └── museums.json
```

## Полезные команды
- Обновить зависимости: `pip install -U -r requirements.txt`
- Форматировать JSON: любой редактор, либо `python -m json.tool data/museums.json`

## FAQ
**Q:** Бот не запускается: `TELEGRAM_BOT_TOKEN is not set`  
**A:** Создайте `.env` по образцу `.env.example` и вставьте токен.

**Q:** Как добавить музей?  
**A:** Откройте `data/museums.json`, добавьте объект с уникальным строковым `id`. Перезапустите бота.

**Q:** Можно ли развернуть на сервере?  
**A:** Да. Настройте systemd‑сервис или используйте Docker — код не привязан к ОС.
